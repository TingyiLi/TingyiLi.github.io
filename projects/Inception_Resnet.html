<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Tingyi Li, Machine Learning, Data Mining, Java, Microsoft" />





  <link rel="alternate" href="/atom.xml" title="Tingyi Li" type="application/atom+xml" />







<meta name="description" content="NameEN: Tingyi Li  |  CN: 李亭宜">
<meta property="og:type" content="website">
<meta property="og:title" content="About">
<meta property="og:url" content="http://tingyili.github.io/about/index.html">
<meta property="og:site_name" content="Tingyi Li">
<meta property="og:description" content="NameEN: Tingyi Li  |  CN: 李亭宜">
<meta property="og:updated_time" content="2019-04-29T03:20:38.019Z">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'post',
    motion: true
  };
</script>

  <title>



    About | Tingyi Li

</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-71292341-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?eed1a5ff91ce000d3cbee31156f82f2c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <div class="container one-column ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">


  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Tingyi Li</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Life is Now.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">



    <ul id="menu" class="menu menu-left">


        <li class="menu-item menu-item-home">
          <a href="/index.html" rel="section">

              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />

            Home
          </a>
        </li>


        <li class="menu-item menu-item-categories">
          <a href="/projects" rel="section">

              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />

            Projects
          </a>
        </li>


        <li class="menu-item menu-item-archives">
          <a href="/space" rel="section">

              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />

            Space
          </a>
        </li>


        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">

              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />

            About
          </a>
        </li>

    </ul>

<div class="site-search">


<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'LwCA4Pqyomh6kHjA4fV9','2.0.0');
</script>




    </div>

</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">


  <div id="posts" class="posts-expand">


      <h1 class="post-title" itemprop="name headline">

            <a class="post-title-link">
            Arm-based FMRI Software Development - Pathological Grade Prediction from Medical Imaging Based on Inception-Resnet-v2
        </a>

      </h1>
      <section>
      <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Classification</h2>
      <h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3>
      <p>In this project, I build a classification model to predict pathological grade from medical imaging based on Inception-Resnet-v3. </p>
      <p>The raw data is data about glioma extracted from <a href="https://www.cancerimagingarchive.net/" target="_blank" rel="external">TCIA</a>. </p>

    <p>Before training, the raw data is processed into data slices and the corresponding pathological grades. The general steps are shown below. </p>
    <div align="center"><br><img src="images/nrrd.png" width="90%" alt="CV" align="center"><br></div>

     <p>Nowadays, the main trend for training CNN on small dataset is transfer learning. The mechanism behind is to train the model based on large datasets while tune the parameters of the trained models using small datasets. In this way, the model could be both adaptive to small datasets with high accuracy.
     Inception Resnet v2 is a newly introduced well performed framework for transfer learning. </p>
     <p> Inception-Resnet-v3 is a CNN released by Google. It is part of the evolution of GoogLeNet, which is a remarkable achievemnet in the exploration of residual learning in inception networks.</p>
      <p>Based on Inception-Restnet-v2, I use the outputs of the bottleneck layer as the extracted features and then classify these features through a dense layer.</p>
      <div align="center"><br><img src="images/incresnetv2-1.png" width="90%" alt="CV" align="center"><br></div>
      <p>The features from two stages are concatenated together and instead of five dense layers, I keep only two layers which means the last three layers are discarded. Then I put these features into a fully connected layer for classification, where each feature is connected to each output.
      The input of the model is sliced images of different pathological grades and the output is the prediction of pathological grade for the slice.</p>
      <p>In this project, I recieved great help from <a href="https://arxiv.org/pdf/1602.07261v1.pdf" target="_blank" rel="external">paper</a>.  </p>

      <h3 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h3>
      <div align="center"><br><img src="images/reslr.png" width="90%" alt="CV" align="center"><br></div>
      <div align="center"><br><img src="images/resacc.png" width="90%" alt="CV" align="center"><br></div>
      I carried out 10 tests to validate the robustness of the model based on the best parameter setting.
      Among the 10 tests, the best one is indicated by the bold line shown in the figure above, with an accuracy of 99.6%.
      <div align="center"><br><img src="images/resrobust.png" width="90%" alt="CV" align="center"><br></div>
    </section>

    <section>
    <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Segmentation</h2>
    <p>Resnet could be regarded as the part to extract features. In order to implement segmentation, I used a prevailing idea of structure in medical imaging segmentation-Unet.</p>
    <div align="center"><br><img src="images/unet.png" width="90%" alt="CV" align="center"><br></div>
    </section>

    <section>
    <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Deployment of Model on Terminal Device</h2>
    <p>In order to build a platform for FMRI software based on the Arm CPU architecture, Armv8.2 LITTLE core Cortex-A55 has been used as the target platform.
      Since there was no single chip on the market for the Cortex-A55 to develop software applications, I need a virtual platform (Virtual Platform) to develop the trained model and analyze system performance.
      The Arm Fast Model is the perfect solution I need.</p>
    <p>I firstly translate my model in C++ for future developing on embedded device. </p>

    <p>I need an efficient development environment that allows me to quickly develop a neural network algorithm from scratch.
      In addition, I also need an image-based analysis tool that allows me to fully grasp the overall system performance trend, where
      <strong>Arm DS5 and Streamline</strong> provide a complete toolchain to meet my development needs.</p>

    <p>I firstly add a cortex-A55 Fixed Virtual Platforms (FVP) debug connection under bare-metal mode.</p>
    <div align="center"><br><img src="images/pmu1.png" width="90%" alt="CV" align="center"><br></div>
    <p>The results from PMU(Performance Mornitor Unit) showed that the first version of the neural networks took up to 18 million instructions to compute on a single picture.</p>

    <p>In order to explore the behavior of actual CPU usage, I used Streamline.</p>
    <!-- <div align="center"><br><img src="images/streamline.png" width="90%" alt="CV" align="center"><br></div> -->
    <div align="center"><br><img src="images/streamcpu1.png" width="90%" alt="CV" align="center"><br></div>
    <p>The cpu load is around 96% which is too high so I decided to optize through compiler by adjusting options for arm compiler 6.</p>
    <div align="center"><br><img src="images/pmu2.png" width="90%" alt="CV" align="center"><br></div>
    <div align="center"><br><img src="images/streamcpu2.png" width="90%" alt="CV" align="center"><br></div>
    <p>Also I decomposed the convolution operation based on <a href="http://proceedings.mlr.press/v70/cho17a/cho17a.pdf"> MEC algorithm</a>. The idea is as shown below. However, the cpu load is still high(86%).</p>
    <div align="center"><br><img src="images/mec.png" width="90%" alt="CV" align="center"><br></div>
    <p>In addition to providing instruction execution information, Streamline also provides the average number of CPU accesses per sample time.
      This information can help me to roughly evaluate the memory usage of the neural networks each inference phase.
     </p>
    <p>The time of cpu accesses reminds me to redesign the API in order to optimize the code structures by reducing redundant for loops. </p>
    <!-- <div align="center"><br><img src="images/API.png" width="90%" alt="CV" align="center"><br></div> -->
    <div align="center"><br><img src="images/pmu3.png" width="90%" alt="CV" align="center"><br></div>
    <div align="center"><br><img src="images/streamcpu3.png" width="90%" alt="CV" align="center"><br></div>
    <p>SystemC/TLM provides a predictive behavioral model based on times series and can be integrated into the Arm fast model.</p>
    </section>

</div>


  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">





      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <img class="site-author-image" src="images/tingyi.png" alt="Tingyi Li" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Tingyi Li</p>
        </div>
        <p class="site-description motion-element" itemprop="description">Life is Now.</p>


        <div class="links-of-author motion-element">

            <span class="links-of-author-item">
             <a href="mailto:tingyi@kth.se"><i class="fa fa-send"></i>Email</a>
            </span>

            <span class="links-of-author-item">
              <a href="https://www.facebook.com/tingyi.li.908" target="_blank">

                  <i class="fa fa-facebook-square" aria-hidden="true"></i> facebook

              </a>
            </span>


            <span class="links-of-author-item">
              <a href="https://github.com/tingyili" target="_blank">

                  <i class="fa fa-github"></i> github

              </a>
            </span>

            <span class="links-of-author-item">
              <a href="https://linkedin.com/in/tingyi-li-3b408616a" target="_blank">

                  <i class="fa fa-linkedin-square" aria-hidden="true"></i> LinkedIn

              </a>
            </span>

        </div>

      </section>



    </div>
  </aside>



    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div class="copyright" >

  &copy;
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tingyi Li</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="powered-by">
  Hosted by <a class="theme-link" href="https://coding.net/pages/">Coding Pages</a>
</div>

<span id="busuanzi_container_site_pv">
  Have a Nice Day ^_^ <span id="busuanzi_value_site_pv"></span>
</span>


      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>


  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>



  <script type="text/javascript" src="/js/bootstrap.js"></script>








  	 <!-- custom analytics part create by xiamo -->
<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("4KyzRuAgl6zwWXQK1UfxmIh0-gzGzoHsz", "YeXrCFBwTG1qRdqS2rUJ7XgJ");</script>
<script>
function showTime(Counter) {
	var query = new AV.Query(Counter);
	$(".leancloud_visitors").each(function() {
		var url = $(this).attr("id").trim();
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length == 0) {
					var content = '0 ' + $(document.getElementById(url)).text();
					$(document.getElementById(url)).text(content);
					return;
				}
				for (var i = 0; i < results.length; i++) {
					var object = results[i];
					var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
					$(document.getElementById(url)).text(content);
				}
			},
			error: function(object, error) {
				console.log("Error: " + error.code + " " + error.message);
			}
		});

	});
}

function addCount(Counter) {
	var Counter = AV.Object.extend("Counter");
	url = $(".leancloud_visitors").attr('id').trim();
	title = $(".leancloud_visitors").attr('data-flag-title').trim();
	var query = new AV.Query(Counter);
	query.equalTo("url", url);
	query.find({
		success: function(results) {
			if (results.length > 0) {
				var counter = results[0];
				counter.fetchWhenSave(true);
				counter.increment("time");
				counter.save(null, {
					success: function(counter) {
						var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					},
					error: function(counter, error) {
						console.log('Failed to save Visitor num, with error message: ' + error.message);
					}
				});
			} else {
				var newcounter = new Counter();
				newcounter.set("title", title);
				newcounter.set("url", url);
				newcounter.set("time", 1);
				newcounter.save(null, {
					success: function(newcounter) {
					    console.log("newcounter.get('time')="+newcounter.get('time'));
						var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					},
					error: function(newcounter, error) {
						console.log('Failed to create');
					}
				});
			}
		},
		error: function(error) {
			console.log('Error:' + error.code + " " + error.message);
		}
	});
}
$(function() {
	var Counter = AV.Object.extend("Counter");
	if ($('.leancloud_visitors').length == 1) {
		addCount(Counter);
	} else if ($('.post-title-link').length > 1) {
		showTime(Counter);
	}
});
</script>


</body>
</html>
